---
- name: upgrade all packages
  yum: name=* state=latest

- name: install CentOS packages for cobbler server
  tags: cobbler
  yum: name={{ item }} state=present
  with_items: cobbler_centos_packages
  when: cobbler_centos_packages is defined

- name: template /etc/cobbler/settings
  template: src=etc/cobbler/settings_{{ ansible_distribution }}.conf.j2 dest=/etc/cobbler/settings owner=root group=root mode=0444
  notify: restart cobblerd

- name: template /etc/cobbler/dhcp.template
  template: src=etc/cobbler/dhcp.template_{{ ansible_distribution }}.conf.j2 dest=/etc/cobbler/dhcp.teplate owner=root group=root mode=0444
  notify: restart cobblerd

- name: template /etc/cobbler/zone.template
  template: src=etc/cobbler/zone.template_{{ ansible_distribution }}.conf.j2 dest=/etc/cobbler/zone.template owner=root group=root mode=0444
  notify: restart cobblerd


- name: template /etc/xinetd.d/tftp
  template: src=etc/xinetd.d/tftp.template_{{ ansible_distribution }}.conf.j2 dest=/etc/xinetd.d/tftp.teplate owner=root group=root mode=0444

- name: turn on xinetd service
  service: name=xinetd enabled=yes

- name: turn on cobblerd service
  service: name=cobblerd enabled=yes
  notify: restart cobblerd

- name: turn on dhcpd service
  service: name=dhcpd enabled=yes
  notify: restart cobblerd

- name: turn on named service
  service: name=named enabled=yes
  notify: restart cobblerd

- name: turn on httpd service
  service: name=httpd enabled=yes
  notify: restart httpd



